version: "3.1"

stories:

- story: show_reservations_1
  steps:
  - intent: greet
  - action: utter_greet
  - intent: show_reservations
  - action: show_reservations_form
  - active_loop: show_reservations_form
  - slot_was_set:
    - requested_slot: PERSON
  - intent: record_PERSON
    entities:
    - PERSON: Joanna Szych
  - slot_was_set:
    - PERSON: Joanna Szych
  - action: show_reservations_form
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit_show_reservations
  - action: action_fetch_reservations
  - intent: goodbye
  - action: utter_goodbye

- story: show_reservations_2
  steps:
  - intent: greet
  - action: utter_greet
  - intent: show_reservations
  - action: show_reservations_form
  - active_loop: show_reservations_form
  - slot_was_set:
    - requested_slot: PERSON
  - intent: record_PERSON
    entities:
    - PERSON: Condrad Flinch
  - slot_was_set:
    - PERSON: Condrad Flinch
  - action: show_reservations_form
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit_show_reservations
  - action: action_fetch_reservations
  - intent: goodbye
  - action: utter_goodbye

- story: show_reservations_3
  steps:
  - intent: show_reservations
  - action: show_reservations_form
  - active_loop: show_reservations_form
  - slot_was_set:
    - requested_slot: PERSON
  - intent: record_PERSON
    entities:
    - PERSON: Joanna Szych
  - slot_was_set:
    - PERSON: Joanna Szych
  - action: show_reservations_form
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit_show_reservations
  - action: action_fetch_reservations
  - intent: goodbye
  - action: utter_goodbye

- story: show_reservations_4
  steps:
  - intent: show_reservations
    entities:
    - PERSON: michal Blajetow
  - slot_was_set:
    - PERSON: michal Blajetow
  - action: show_reservations_form
  - active_loop: show_reservations_form
  - slot_was_set:
    - PERSON: michal Blajetow
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_submit_show_reservations
  - action: action_fetch_reservations

- story: User wants additional filters but doesn't specify immediately
  steps:
    - intent: find_restaurant
    - action: find_restaurant_form
    - active_loop: find_restaurant_form
    - active_loop: null 
    - action: utter_ask_if_additional_filters
    - slot_was_set:
        - requested_slot: null
    - intent: confirm 
    - action: utter_ask_for_optional_filters  
    - intent: record_filters  
    - slot_was_set:
        - pricing: "cheap"
    - action: action_map_pricing  
    - action: action_find_restaurant

- story: User doesn't want additional filters 
  steps:
    - intent: find_restaurant
    - action: find_restaurant_form
    - active_loop: find_restaurant_form
    - active_loop: null 
    - action: utter_ask_if_additional_filters
    - slot_was_set:
        - requested_slot: null
    - intent: deny  
    - action: action_find_restaurant

- story: User provides pricing filter in the first response
  steps:
    - intent: find_restaurant
    - action: find_restaurant_form
    - active_loop: find_restaurant_form
    - active_loop: null 
    - action: utter_ask_if_additional_filters
    - intent: record_filters
    - slot_was_set:
        - pricing: "cheap"
    - action: action_map_pricing  
    - action: action_find_restaurant

- story: User says "yes" to additional filters and provides pricing
  steps:
    - intent: find_restaurant
    - action: find_restaurant_form
    - active_loop: find_restaurant_form
    - active_loop: null 
    - action: utter_ask_if_additional_filters
    - intent: confirm
    - action: utter_ask_for_optional_filters  # Bot asks for details
    - intent: record_filters
    - slot_was_set:
        - pricing: "moderately priced"
    - action: action_map_pricing 
    - action: action_find_restaurant
